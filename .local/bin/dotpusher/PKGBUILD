pkgname=dotpusher
pkgver=0.1.0
pkgrel=1
pkgdesc="Dotpusher is a declarative method for synchronizing local files or directories with remote ones using git."
arch=('any')
url="https://github.com/maarutan/dotpusher"
license=('MIT')
depends=()
makedepends=('python' 'pyinstaller')
options=('!strip')
source=("main.py")
sha256sums=('SKIP')

build() {
    if command -v pyinstaller >/dev/null 2>&1; then
        pyinstaller --onefile main.py
    else
        echo "PyInstaller not found â€” using main.py as a fallback."
        if ! command -v python >/dev/null 2>&1; then
            echo "Python is not installed, cannot build fallback."
            exit 1
        fi
        cp main.py dotpusher
        chmod +x dotpusher
        mkdir -p dist
        mv dotpusher dist/
    fi
}

package() {
    install -Dm755 "dist/dotpusher" "$pkgdir/usr/bin/dotpusher"
}

